<div>
  <div>
    <h2>
      Administrar <span class="ml-3" style="font-size: 28px;">&#8226;</span>
      <span class="ml-3" style="color:#58544E; font-size: 25px;">Usuarios</span>
    </h2>
  </div>

  <div class="card-body">
    <div class="d-flex justify-content-between">
      <button nz-button (click)="openAddUsersModal()">Crear Usuario</button>
      <button [disabled]="filterForm.invalid" nz-button (click)="removeFilters()">Quitar filtros</button>
      <button nz-button class="yellowButton" (click)="openMassLoadUsersModal()">
        Carga Masiva de Usuarios
      </button>
    </div>


    <form class="row mt-4" [formGroup]="filterForm" (ngSubmit)="FilterFormOnSubmit()">
      <div class="col-4">
        <nz-form-control [nzErrorTip]="errorTpl">
          <nz-select  nzSuffixIcon="filter" nzShowSearch nzAllowClear style="width: 100%;" nz-input name="select-error" formControlName="filterType">
            <nz-option nzValue="" nzLabel="-- Seleccione --"></nz-option>
            <nz-option *ngFor="let filterItem of filterList" [nzLabel]="filterItem" [nzValue]="filterItem"></nz-option>
          </nz-select>
          <ng-template #errorTpl let-control>
            <ng-container *ngIf="f.filterType.hasError('required')">
              Seleccione rol
            </ng-container>
          </ng-template>
        </nz-form-control>
      </div>
      <div class="col-4">
        <nz-form-control [nzErrorTip]="errorTpl">
          <input placeholder="xxxx@gmail.com" nz-input style="font-family: FontAwesome;  width: 100%;" name="searchTerm" class="form-control" type="text" formControlName="filterValue"/>
          <ng-template #errorTpl let-control>
            <ng-container *ngIf="f.filterValue.hasError('required')">
              Ingrese el valor
            </ng-container>
          </ng-template>
        </nz-form-control>
      </div>
      <button [disabled]="filterForm.invalid" nz-button nzType="primary" type="submit">Filtrar</button>
    </form>

    <br>
    <nz-table
    nzShowSizeChanger
    [nzData]="people['rows']"
    [nzFrontPagination]="false"  
    [nzLoading]="loading"
    [nzTotal]="total"
    [nzPageSize]="pageSize"
    [nzPageIndex]="pageIndex"
    (nzQueryParams)="onQueryParamsChange($event)"
    >
    <thead>
      <tr>
        <th nzColumnKey="id">ID</th>
        <th nzColumnKey="document">CÃ©dula</th>
        <th nzColumnKey="name">Nombre</th>
        <th nzColumnKey="company_role">Rol</th>
        <th nzColumnKey="email">Correo</th>
        <th nzColumnKey="mobile">Celular</th>
        <th nzColumnKey="phone">Telefono</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let employee of people['rows']">
        <td>{{ employee.id }}</td>
        <td>{{ employee.document }}</td>
        <td>{{ employee.name }}</td>
        <td>{{ employee.company_role }}</td>
        <td>{{ employee.email }}</td>
        <td>{{ employee.mobile }}</td>
        <td>{{ employee.phone }}</td>
        <td>
          <a
              nzTooltipTitle="Editar"
              nzTooltipPlacement="top"
              nz-tooltip
              class="iconTableLink"
              (click)="selectEmployeeForEdit(employee)"
              ><i class="fe fe-edit"></i
            ></a>
        </td>
      </tr>
    </tbody>
    </nz-table>
   
    <div class="d-flex justify-content-between p-2">
      <button type="button" nz-button [disabled]="downloadExcelLoader" (click)="getDataForDownloadExcel()">
        {{ (downloadExcelLoader) ? 'Cargando...' : 'Descargar' }}
        <img style="width: 50px;" src="../../../../assets/Imagenes/Copia de 001-excel copy.svg" />
      </button>
    </div>
  </div>
</div>

<!-----------------Add Modal Add User--------------->
<nz-modal
  [(nzVisible)]="isAddUserModalOpen"
  nzFooter="null"
  [nzTitle]="modalTitle2"
  [nzContent]="modalContent2"
  [nzWidth]="1000"
  class="addUser"
  (nzOnCancel)="closeAddUserModal()"
  nzWrapClassName="vertical-center-modal"
>
  <ng-template #modalTitle2>
    <h4>Crear usuario</h4>
  </ng-template>

  <ng-template #modalContent2>
    <app-add-user></app-add-user>
  </ng-template>
</nz-modal>

<!---------------------Modal Editar Usuario---------------->
<nz-modal
  nzWrapClassName="vertical-center-modal"
  [(nzVisible)]="isEditUserModalOpen"
  nzFooter="null"
  [nzTitle]="modalTitle"
  [nzContent]="modalContent"
  class="editUser"
  (nzOnCancel)="closeEditUserModal()"
>
  <ng-template #modalTitle>
    <h4>Detalle de usuario</h4>
  </ng-template>

  <ng-template #modalContent>
   <app-edit-user></app-edit-user>
  </ng-template>
</nz-modal>

<!-----------------Add Modal Carga Masiva--------------->
<nz-modal
  [(nzVisible)]="isMassLoadUserModalOpen"
  nzFooter="null"
  [nzTitle]="modalTitle3"
  [nzContent]="modalContent3"
  [nzWidth]="500"
  class="addUser"
  (nzOnCancel)="closeMassLoadUserModal()"
  nzWrapClassName="vertical-center-modal"
>
  <ng-template #modalTitle3>
    <h4>Carga masiva de usuarios</h4>
  </ng-template>

  <ng-template #modalContent3>
   <app-mass-load-users></app-mass-load-users>
  </ng-template>
</nz-modal>

